"use strict";(self["webpackChunkmarket"]=self["webpackChunkmarket"]||[]).push([[202],{3582:function(e,r,t){t.d(r,{s:function(){return i}});t(7658),t(1703);var l=t(7176),a=t(6795),o=t(2483);const s=(0,a.t)(),n=(0,o.tv)(),i={async allByUser(){s.is_login||n.push({name:"Login"});let e={url:"/bookings/by-user",token:s.token};try{let r=await l.E.request(e);if(!r)throw{msg:"Error en la solicitud de las allByUser",error:r};return r}catch(r){let t=`Error ${r.response?.status}: ${r.response?.statusText}\nURL: ${e.url}\nResponse data: ${JSON.stringify(r.response?.data)}`;throw new Error(t)}},async create(e){s.token||s.getToken();let r={url:"/booking/create",token:s.token,method:"post",data:{data:e}};console.log(r);try{let e=await l.E.request(r);if(!e)throw{msg:"Error en la solicitud de las create",error:e};return e}catch(t){let e=`Error ${t.response?.status}: ${t.response?.statusText}\nURL: ${r.url}\nResponse data: ${JSON.stringify(t.response?.data)}`;throw new Error(e)}}}},9207:function(e,r,t){t.d(r,{R:function(){return s}});t(1703),t(7658);var l=t(7176),a=t(6795);const o=(0,a.t)(),s={async allProducts(){let e="/marketplace-items";try{let r=await l.E.request({url:e});if(!r)throw{msg:"Error en la solicitud de los productos",error:r};return r}catch(r){let t=`Error ${r.response?.status}: ${r.response?.statusText}\nURL: ${e}\nResponse data: ${JSON.stringify(r.response?.data)}`;throw new Error(t)}},async searchProduct(e){let r="/marketplace-items/search-by-criteria";try{o.token||o.getToken();let t={url:r,method:"post",token:o.token,data:e},a=await l.E.request(t);if(!a)throw{msg:"Error en la solicitud del producto",error:a};return a}catch(t){let e=`Error ${t.response?.status}: ${t.response?.statusText}\nURL: ${r}\nResponse data: ${JSON.stringify(t.response?.data)}`;throw new Error(e)}},async getProductId(e){let r=`/marketplace-items/${e}`;try{o.token||o.getToken();let e={url:r,token:o.token},t=await l.E.request(e);if(!t)throw{msg:"Error en la solicitud del producto",error:t};return t}catch(t){let e=`Error ${t.response?.status}: ${t.response?.statusText}\nURL: ${r}\nResponse data: ${JSON.stringify(t.response?.data)}`;throw new Error(e)}},async getProductKeyword(e){o.token||o.getToken();let r={url:"/marketplace-items/search-by-criteria",method:"post",token:o.token,data:{keyword:e}};try{let e=await l.E.request(r);if(!e)throw{msg:"Error en la solicitud del producto",error:e};return e}catch(t){let e=`Error ${t.response?.status}: ${t.response?.statusText}\nURL: ${r.url}\nResponse data: ${JSON.stringify(t.response?.data)}`;throw new Error(e)}},async getProducts(e){try{let r=e.map((e=>this.getProductId(e.id))),t=await Promise.all(r);if(0===t.length)throw{msg:"Error en la función getProducts"};return t}catch(r){let e=`Error ${r.response?.status}: ${r.response?.statusText}\nResponse data: ${JSON.stringify(r.response?.data)}`;throw new Error(e)}},mergeCartWithList(e,r){try{return e.forEach((e=>{r.forEach((r=>{e.id===r.id&&(e.count=r.count)}))})),e}catch(t){let e={msg:"Error en mergeCartWithList",error:t};throw new Error(e)}},getProductsWithPrice(e){try{const r=[];return e.forEach((e=>{const t=e,l={marketplace_item_id:t.id,date:(new Date).toISOString().slice(0,10),cant:t.count,price:(t.count*t.price).toString()};r.push(l)})),r}catch(r){let e={msg:"Error en mergeCartWithList",error:r};throw new Error(e)}},getTotalPriceOfAllProducts(e){try{let r=0;return e.forEach((e=>{r+=e.count*e.price})),r}catch(r){let e={msg:"Error en mergeCartWithList",error:r};throw new Error(e)}}}},2440:function(e,r,t){t.d(r,{Z:function(){return u}});var l=t(3396),a=t(7139),o=t(9595),s=t(4870);const n={class:"flex items-center justify-between rounded-lg"};var i={__name:"BtnAddLess",props:{item:Object},emits:["updCart"],setup(e,{emit:r}){const t=e,i=(0,o.x)(),c=(0,s.iH)(!1),u=()=>{p(),i.addProduct(t.item),r("updCart")},d=()=>{p(),i.removeProduct(t.item),r("updCart")},p=()=>{c.value=!0,setTimeout((()=>{c.value=!1}),500)},v=(0,l.Fl)((()=>{const e=i.prods.find((e=>e.id===t.item.id));return e?e.count:0}));return(e,r)=>((0,l.wg)(),(0,l.iD)("div",n,[(0,l._)("button",{class:"rounded-l-lg bg-gray-300 w-8",onClick:r[0]||(r[0]=e=>d())},"-"),(0,l._)("div",{class:(0,a.C_)(["w-8 text-gray-800",{"scale-150 transition-transform animate-spin":c.value}])},(0,a.zw)(v.value),3),(0,l._)("button",{class:"rounded-r-lg bg-gray-300 w-8",onClick:r[1]||(r[1]=e=>u())},"+")]))}};const c=i;var u=c},8089:function(e,r,t){t.r(r),t.d(r,{default:function(){return te}});var l=t(3396),a=t(4870),o=t(7139),s=t(9242),n=t(1728),i=t(2492),c=t.n(i),u=t(9204),d=t(2682),p=t(5562),v=t(1549),_=t(9709),m=t(6795),f=t(9595),g=t(9207),w=t(3582);const x=e=>((0,l.dD)("data-v-b16d3c70"),e=e(),(0,l.Cn)(),e),y={class:"flex gap-5"},h={class:"flex flex-col w-11/12 gap-5"},b=x((()=>(0,l._)("span",{class:"text-gray-400"},"Los campos con * son obligatorios",-1))),k={class:"flex flex-col gap-3"},E={class:"flex flex-col gap-5"},C={class:"flex flex-col md:flex-row gap-5 w-full"},S={class:"flex flex-col flex-1"},U={class:"span_error"},P={class:"flex flex-col flex-1"},$={class:"span_error"},q={class:"flex flex-col md:flex-row gap-5 w-full"},L={class:"flex flex-col flex-1"},V={class:"span_error"},T={class:"flex flex-col flex-1"},I={class:"span_error"},R={class:"flex flex-col md:flex-row gap-5 w-full"},z={class:"flex flex-col flex-1"},D={class:"span_error"},O={class:"flex flex-col flex-1"},j={class:"py-6 text-3xl"},W=x((()=>(0,l._)("i",{class:"fa fa-spinner fa-pulse"},null,-1))),H=[W],N={class:"span_error"},Z={class:"flex flex-col md:flex-row gap-5 w-full"},J={class:"flex flex-col flex-1"},B={class:"span_error"},F={class:"flex flex-col flex-1"},A={class:"span_error"},Y={class:"flex flex-col md:flex-row gap-5 w-full"},K={class:"flex flex-col flex-1"},M={class:"span_error"},X={class:"flex flex-col flex-1"},G={class:"span_error"};var Q={__name:"BuyFormView",setup(e){const r=(0,m.t)(),t=(0,f.x)(),{validateOnlyText:i,validateOnlyInteger:x,validatePhone:W,validateCi:Q,validateEmail:ee}=(0,u.Z)(),re=(0,a.iH)({}),te=(0,a.iH)([]),le=(0,a.iH)([]),ae=(0,a.iH)([]),oe=(0,a.iH)(!1);(0,l.wF)((async()=>{[te.value,ae.value]=await Promise.all([v.d.getSimpleList(),p.X.getSimpleList()])}));const se=(0,a.iH)({name_receiver:"",last_name_receiver:"",country_receiver:"",province_receiver:null,city_receiver:null,address_receiver:"",email_receiver:"",phone_receiver:"",postal_code_receiver:"",ci_receiver:"",obs:""}),ne=async()=>{try{oe.value=!0,le.value=await _.F.getSimpleList(se.value.province_receiver)}catch(e){console.log(e)}finally{oe.value=!1}};(0,l.YP)((()=>se.value.province_receiver),(()=>{ne()}));const ie=(e,r,t)=>r(se.value[e])||""===se.value[e]?(re.value[e]="",!1):(re.value[e]=t,!0),ce=e=>{let r=!0;return e.forEach((e=>{se.value[e]?re.value[e]="":(re.value[e]="El campo es requerido",r=!1)})),r};let ue=()=>ie("name_receiver",i,"El nombre no es válido"),de=()=>ie("last_name_receiver",i,"El apellido no es válido"),pe=()=>ie("email_receiver",ee,"El email no es válido"),ve=()=>ie("phone_receiver",W,"El teléfono no es válido"),_e=()=>ie("postal_code_receiver",x,"El código postal no es válido"),me=()=>ie("ci_receiver",Q,"El CI no es válido");const fe=e=>ae.value.filter((r=>r.value===e)),ge=async e=>{e.preventDefault();let l=["name_receiver","last_name_receiver","email_receiver","phone_receiver","province_receiver","city_receiver","address_receiver","ci_receiver"];if(!ce(l))return c().fire({title:"Validación",text:"Error de validación, revise los datos introducidos",icon:"error",confirmButtonColor:"#3085d6"});try{let e=await g.R.getProducts(t.prods);e=g.R.mergeCartWithList(e,t.prods);let l=await r.whoIsLogin(),a=fe(se.value.country_receiver)?fe(se.value.country_receiver)[0].text:"",o={description:se.value.obs,destination:a,email:l.email,name:l.first_name+" "+l.last_name,phone:l.phone,price:g.R.getTotalPriceOfAllProducts(e).toString(),product:"MarketItem",deliver:{name:se.value.name_receiver,lastname:se.value.last_name_receiver,dni:se.value.ci_receiver,phone:se.value.phone_receiver,address:se.value.address_receiver,city_id:se.value.city_receiver},prod:g.R.getProductsWithPrice(e)};console.log(o);let s=await w.s.create(o);console.log(s)}catch(a){return console.log(a),c().fire({title:"Error",text:"Error en la solicitud puede, revise los datos introducido o puede intentar más tarde",icon:"error",confirmButtonColor:"#3085d6"})}};return(e,r)=>((0,l.wg)(),(0,l.j4)(n.Z,null,{default:(0,l.w5)((()=>[(0,l._)("section",y,[(0,l._)("div",h,[b,(0,l._)("div",k,[(0,l._)("div",E,[(0,l._)("div",C,[(0,l._)("div",S,[(0,l.wy)((0,l._)("input",{type:"text",placeholder:"Nombre del receptor*","onUpdate:modelValue":r[0]||(r[0]=e=>se.value.name_receiver=e),onInput:r[1]||(r[1]=(...e)=>(0,a.SU)(ue)&&(0,a.SU)(ue)(...e)),class:(0,o.C_)(["input_form",{input_form_error:re.value.name_receiver}]),required:""},null,34),[[s.nr,se.value.name_receiver]]),(0,l._)("span",U,(0,o.zw)(re.value.name_receiver),1)]),(0,l._)("div",P,[(0,l.wy)((0,l._)("input",{type:"text",placeholder:"Apellidos del receptor*","onUpdate:modelValue":r[2]||(r[2]=e=>se.value.last_name_receiver=e),onInput:r[3]||(r[3]=(...e)=>(0,a.SU)(de)&&(0,a.SU)(de)(...e)),class:(0,o.C_)(["input_form",{input_form_error:re.value.last_name_receiver}]),required:""},null,34),[[s.nr,se.value.last_name_receiver]]),(0,l._)("span",$,(0,o.zw)(re.value.last_name_receiver),1)])]),(0,l._)("div",q,[(0,l._)("div",L,[(0,l.Wm)((0,a.SU)(d.q2),{options:ae.value,modelValue:se.value.country_receiver,"onUpdate:modelValue":r[4]||(r[4]=e=>se.value.country_receiver=e),placeholder:"Seleccione el País*",required:"",class:(0,o.C_)(["input_form",{input_form_error:re.value.country_receiver}])},null,8,["options","modelValue","class"]),(0,l._)("span",V,(0,o.zw)(re.value.country_receiver),1)]),(0,l._)("div",T,[(0,l.wy)((0,l._)("input",{type:"text",placeholder:"Dirección del receptor*","onUpdate:modelValue":r[5]||(r[5]=e=>se.value.address_receiver=e),required:"",class:(0,o.C_)(["input_form",{input_form_error:re.value.address_receiver}])},null,2),[[s.nr,se.value.address_receiver]]),(0,l._)("span",I,(0,o.zw)(re.value.address_receiver),1)])]),(0,l._)("div",R,[(0,l._)("div",z,[(0,l.Wm)((0,a.SU)(d.q2),{options:te.value,placeholder:"Seleccione la provincia*",modelValue:se.value.province_receiver,"onUpdate:modelValue":r[6]||(r[6]=e=>se.value.province_receiver=e),onSearchchange:ne,required:"",class:(0,o.C_)(["input_form",{input_form_error:re.value.province_receiver}])},null,8,["options","modelValue","class"]),(0,l._)("span",D,(0,o.zw)(re.value.province_receiver),1)]),(0,l._)("div",O,[(0,l.wy)((0,l._)("div",j,H,512),[[s.F8,oe.value]]),(0,l.wy)((0,l.Wm)((0,a.SU)(d.q2),{options:le.value,modelValue:se.value.city_receiver,"onUpdate:modelValue":r[7]||(r[7]=e=>se.value.city_receiver=e),placeholder:"Seleccione el municipio*",required:"",class:(0,o.C_)(["input_form",{input_form_error:re.value.city_receiver}])},null,8,["options","modelValue","class"]),[[s.F8,!oe.value]]),(0,l._)("span",N,(0,o.zw)(re.value.city_receiver),1)])]),(0,l._)("div",Z,[(0,l._)("div",J,[(0,l.wy)((0,l._)("input",{type:"text",placeholder:"Escriba su CI*","onUpdate:modelValue":r[8]||(r[8]=e=>se.value.ci_receiver=e),required:"",class:(0,o.C_)(["input_form",{input_form_error:re.value.ci_receiver}]),onInput:r[9]||(r[9]=(...e)=>(0,a.SU)(me)&&(0,a.SU)(me)(...e))},null,34),[[s.nr,se.value.ci_receiver]]),(0,l._)("span",B,(0,o.zw)(re.value.ci_receiver),1)]),(0,l._)("div",F,[(0,l.wy)((0,l._)("input",{type:"text",placeholder:"Código postal del receptor","onUpdate:modelValue":r[10]||(r[10]=e=>se.value.postal_code_receiver=e),required:"",class:(0,o.C_)(["input_form",{input_form_error:re.value.postal_code_receiver}]),onInput:r[11]||(r[11]=(...e)=>(0,a.SU)(_e)&&(0,a.SU)(_e)(...e))},null,34),[[s.nr,se.value.postal_code_receiver]]),(0,l._)("span",A,(0,o.zw)(re.value.postal_code_receiver),1)])]),(0,l._)("div",Y,[(0,l._)("div",K,[(0,l.wy)((0,l._)("input",{type:"email",placeholder:"Email del receptor","onUpdate:modelValue":r[12]||(r[12]=e=>se.value.email_receiver=e),onInput:r[13]||(r[13]=(...e)=>(0,a.SU)(pe)&&(0,a.SU)(pe)(...e)),class:(0,o.C_)(["input_form",{input_form_error:re.value.email_receiver}]),required:""},null,34),[[s.nr,se.value.email_receiver]]),(0,l._)("span",M,(0,o.zw)(re.value.email_receiver),1)]),(0,l._)("div",X,[(0,l.wy)((0,l._)("input",{type:"tel",placeholder:"Teléfono del receptor*","onUpdate:modelValue":r[14]||(r[14]=e=>se.value.phone_receiver=e),required:"",onInput:r[15]||(r[15]=(...e)=>(0,a.SU)(ve)&&(0,a.SU)(ve)(...e)),class:(0,o.C_)(["input_form",{input_form_error:re.value.phone_receiver}])},null,34),[[s.nr,se.value.phone_receiver]]),(0,l._)("span",G,(0,o.zw)(re.value.phone_receiver),1)])]),(0,l.wy)((0,l._)("textarea",{"onUpdate:modelValue":r[16]||(r[16]=e=>se.value.obs=e),class:"w-full input_form",placeholder:"Escriba algún otro dato aquí"},null,512),[[s.nr,se.value.obs]])])]),(0,l._)("div",{class:"flex justify-end"},[(0,l._)("button",{type:"submit",class:"btn-send",onClick:ge},"Enviar")])])])])),_:1}))}},ee=t(89);const re=(0,ee.Z)(Q,[["__scopeId","data-v-b16d3c70"]]);var te=re},7537:function(e,r,t){t.r(r),t.d(r,{default:function(){return j}});var l=t(3396),a=t(4870),o=t(7139),s=t(1728),n=t(9595),i=(t(7658),t(2440)),c=t(2483),u=t(1020);const d=e=>((0,l.dD)("data-v-3035ebbb"),e=e(),(0,l.Cn)(),e),p=["src"],v={class:"flex flex-col w-full p-5 border-l border-gray-300"},_={class:"flex justify-between mt-2 mb-3"},m=["textContent"],f={class:"flex justify-start my-3 gap-5"},g=["textContent"],w=d((()=>(0,l._)("div",{class:"flex justify-start ml-6 my-3"},null,-1))),x={class:"flex gap-4 w-full justify-between items-end"},y={class:"flex flex-col"},h={class:"text-amber-500 text-lg"};var b={__name:"CartListTemplate",props:{item:Object},setup(e){const r=e,t=(0,c.tv)(),s=(0,n.x)(),{prodPrice:d}=(0,u.Jk)(s),b=(0,a.iH)(!1),k=(0,a.iH)(!1),E=()=>{t.push({name:"ProductDetail",params:{keyword:r.item.name}})},C=e=>{b.value=!0,setTimeout((()=>{s.deleteAllProductsOf(e),b.value=!1}),1e3)},S=()=>{k.value=!0,setTimeout((()=>{k.value=!1}),500)};return(e,t)=>{const s=(0,l.up)("router-link");return(0,l.wg)(),(0,l.iD)("article",{class:(0,o.C_)(["flex border border-gray-300 rounded-lg",{"style-remove":b.value}])},[r.item.images&&r.item.images.lenght>0?((0,l.wg)(),(0,l.iD)("figure",{key:0,class:"flex items-center w-60 h-52 px-1 bg-cover overflow-hidden hover:cursor-pointer",onClick:E},[r.item.images[0].resources[0].url?((0,l.wg)(),(0,l.iD)("img",{key:0,src:r.item.images[0].resources[0].url,alt:"",class:"bg-slate-400"},null,8,p)):(0,l.kq)("",!0)])):(0,l.kq)("",!0),(0,l._)("div",v,[(0,l._)("h4",{class:"text-gray-800 text-2xl my-2 hover:cursor-pointer text-left",onClick:E},(0,o.zw)(r.item.name),1),(0,l._)("div",_,[(0,l._)("p",{class:"text-justify w-9/12 text-gray-800",textContent:(0,o.zw)(r.item.description)},null,8,m),(0,l._)("span",{class:(0,o.C_)(["mr-10 text-2xl text-gray-800",{"scale-110 transition-transform animate-spin":k.value}])}," $"+(0,o.zw)((0,a.SU)(d)(r.item.id)),3)]),(0,l._)("div",f,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.item.marketplace_categories,((e,r)=>((0,l.wg)(),(0,l.j4)(s,{key:r,to:{name:"ListProduct",params:{keyword:e.alias}}},{default:(0,l.w5)((()=>[(0,l._)("span",{class:"text-sm text-amber-800 bg-amber-200 px-3 py-2 rounded-lg my-5",textContent:(0,o.zw)(e.alias)},null,8,g)])),_:2},1032,["to"])))),128))]),w,(0,l._)("div",x,[(0,l._)("div",y,[(0,l._)("h4",h,"$"+(0,o.zw)(r.item.price),1),(0,l.Wm)((0,a.SU)(i.Z),{item:r.item,onUpdCart:S},null,8,["item"])]),(0,l._)("button",{class:"bg-sky-800 px-5 py-2 rounded-lg text-white",onClick:t[0]||(t[0]=e=>C(r.item.name))},"Eliminar")])])],2)}}},k=t(89);const E=(0,k.Z)(b,[["__scopeId","data-v-3035ebbb"]]);var C=E,S=t(6795);const U={class:"flex flex-col w-full rounded-lg border border-gray-300 gap-5 items-center p-5 pb-10"};var P={__name:"PanelCart",emits:["clearProducts"],setup(e,{emit:r}){const t=(0,S.t)(),s=(0,c.tv)(),i=(0,n.x)(),u=()=>{r("clearProducts")},d=()=>{s.go(-1)},p=()=>{t.is_login?s.push({name:"BuyForm"}):s.push({name:"Login"})};return(e,r)=>((0,l.wg)(),(0,l.iD)("div",U,[(0,l.Uk)(" Subtotal: "+(0,o.zw)((0,a.SU)(i).totalPrice)+" ",1),(0,l._)("button",{class:"btn-clear",onClick:r[0]||(r[0]=e=>u())},"Vaciar"),(0,l._)("button",{class:"btn-go-back",onClick:r[1]||(r[1]=e=>d())},"Seguir"),(0,l._)("button",{class:"btn-buy",onClick:r[2]||(r[2]=e=>p())},"Pagar")]))}};const $=(0,k.Z)(P,[["__scopeId","data-v-043d7ba2"]]);var q=$;const L=e=>((0,l.dD)("data-v-68acde28"),e=e(),(0,l.Cn)(),e),V={key:0,class:"flex flex-col-reverse lg:flex-row w-full gap-5"},T=L((()=>(0,l._)("div",{class:"flex flex-col gap-5 lg:w-9/12"},[(0,l._)("span",{class:"text-2xl"},"No hay productos")],-1))),I={class:"lg:w-3/12"},R={key:1,class:"flex flex-col-reverse lg:flex-row w-full gap-5"},z={class:"lg:w-3/12"};var D={__name:"ShoppingCartView",setup(e){const r=(0,n.x)(),t=(0,a.iH)(!1),i=async()=>{t.value=!0,await(0,l.Y3)(),setTimeout((()=>{t.value=!1,r.clearAllProducts()}),3500)};return(e,n)=>((0,l.wg)(),(0,l.j4)(s.Z,null,{default:(0,l.w5)((()=>[0!==(0,a.SU)(r).totalProducts||t.value?((0,l.wg)(),(0,l.iD)("div",R,[(0,l._)("div",{class:(0,o.C_)(["flex flex-col gap-5 lg:w-9/12",{"style-remove-all":t.value}])},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,a.SU)(r).prods,((e,r)=>((0,l.wg)(),(0,l.j4)(C,{key:r,item:e},null,8,["item"])))),128))],2),(0,l._)("div",z,[(0,l.Wm)(q,{onClearProducts:i})])])):((0,l.wg)(),(0,l.iD)("div",V,[T,(0,l._)("div",I,[(0,l.Wm)(q)])]))])),_:1}))}};const O=(0,k.Z)(D,[["__scopeId","data-v-68acde28"]]);var j=O}}]);
//# sourceMappingURL=shopping_cart.9529136c.js.map